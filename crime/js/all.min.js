var makeInfo;makeInfo=function(e,r,n){var t,o,i,c,u,a,l,s,f,d,g,v,m,p,h,b,_,A,k,C,w,D,y,N,j,S,x,R,E;return t=2013,k={},n.forEach(function(e){return k[e.RegionCode]=e.RegionName}),C=function(e){return k[e]?k[e]:"-"},_=topojson.feature(r,r.objects.russia).features,_.forEach(function(e){return e.properties.name=C(e.properties.region)}),w=crossfilter(n),g=w.dimension(function(e){return e.RegionName}),d=w.dimension(function(e){return e.RegionCode}),E=g.group().reduceSum(function(e){return e[t]}),x=d.group().reduceSum(function(e){return e[t]}),a=w.dimension(function(e){return e[t]}),A=a.top(1)[0][t],s=w.dimension(function(e){return"Central"===e.fdistrict?"Центральный":"Northwestern"===e.fdistrict?"Северо-Западный":"Southern"===e.fdistrict?"Южный":"Northcaucasian"===e.fdistrict?"Северо-Кавказский":"Volga"===e.fdistrict?"Приволжский":"Urals"===e.fdistrict?"Уральский":"Siberia"===e.fdistrict?"Сибирский":"Far_Eastern"===e.fdistrict?"Дальневосточный":0}),f=s.group(),p=w.dimension(function(e){return e[t]>2149?"Очень высокий":e[t]>1800?"Высокий":e[t]>1300?"Средний":e[t]>1e3?"Низкий":"Очень низкий"}),h=p.group().reduce(function(e,r){return++e.count,e.total+=r[t],e.avg=e.count?Math.round(e.total/e.count):0,e},function(e,r){return--e.count,e.total-=r[t],e},function(){return{count:0,total:0,avg:0}}),o=w.groupAll(),c=g.group().reduceCount(function(e){return e[t]}),R=w.groupAll().reduceSum(function(e){return e[t]}),N=o.reduce(function(e,r){return++e.count,e.total+=r[t],e.avg=e.count?Math.round(e.total/e.count):0,e},function(e,r){return--e.count,e.total-=r[t],e.avg=e.count?Math.round(e.total/e.count):0,e},function(){return{count:0,total:0,avg:0}}),m=d3.scale.ordinal().domain(0,5).range(["#fee0d2","#fcbba1","#fb6a4a","#cb181d","#67000d"]),b=d3.scale.ordinal().domain(0,8).range(["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]),S=d3.scale.linear().domain([0,A]).range(["#fee0d2","#e31a1c"]),l=dc.rowChart(".district__svg"),l.width(900).height(220).dimension(s).colors(b).label(function(e){return e.key+" ("+e.value+")"}).group(f).xAxis().ticks(18),$(".district .reset").on("click",function(e){return e.preventDefault(),l.filterAll(),dc.renderAll()}),v=dc.rowChart(".levels__svg"),v.width(230).height(140).dimension(p).group(h).title(function(e){return e.value.count}).colors(m).valueAccessor(function(e){return 50}).ordering(function(e){return e.value.avg}).labelOffsetX(25).render().valueAccessor(function(e){return 5}),y=d3.geo.albers().rotate([-105,0]).center([-10,65]).parallels([52,64]).scale(600).translate([450,225]),r=dc.geoChoroplethChart(".map__svg"),r.width(900).height(450).dimension(d).group(x).colors(["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]).colorDomain([0,A]).overlayGeoJson(_,"region",function(e){return e.properties.region}).title(function(e){return C(e.key)+": "+e.value}).projection(y),$(".map .reset").on("click",function(e){return e.preventDefault(),r.filterAll(),dc.renderAll()}),j=dc.rowChart(".regions__svg"),j.width(380).height(1200).dimension(g).group(E).colorAccessor(function(e){return e.value}).colors(S).gap([1]).labelOffsetX([1]).elasticX(!1).xAxis().ticks(4),$(".regions .reset").on("click",function(e){return e.preventDefault(),j.filterAll(),dc.renderAll()}),i=$(".regions .controls__btn-wrap"),i.on("click",function(e){var r,n;return e.preventDefault(),n=$(this),r=n.find(".controls__btn"),n.hasClass("active")?void 0:("#ascending"===r.attr("href")?j.ordering(function(e){return-e.value}).render():"#alfabetical"===r.attr("href")&&j.ordering(function(e){return e.key}).render(),n.addClass("active").siblings().removeClass("active"))}),u=dc.numberDisplay(".select-regions__svg"),u.formatNumber(d3.format("d")).group(N).valueAccessor(function(e){return e.count}),D=dc.numberDisplay(".aver-crime__svg"),D.formatNumber(d3.format("d")).group(N).valueAccessor(function(e){return e.avg}),dc.renderAll(),$(".aver-crime__svg").on("click",function(e){return e.preventDefault(),console.log("hi"),j.filterAll(),dc.renderAll()})},queue().defer(d3.json,"raw.githubusercontent.com/neonov/neonov.github.io/master/crime/data/MAP").defer(d3.json,"raw.githubusercontent.com/neonov/neonov.github.io/master/crime/data/DATA").await(makeInfo);
//# sourceMappingURL=all.min.js.map