(function(){}).call(this),function(){}.call(this),function(){var t;t=function(t){var e,r,n,a,o,l,i,s,c,u,d,f,p,g,h,x,m,v,y,b,F,w,Y,C,A;return y=["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],t.forEach(function(t){return delete t._id}),l=function(){var e;return e=[],t.forEach(function(t){var r,n;return r=Object.keys(t),n=r.map(function(e){return t[e]}),e.push(n)}),e},i=function(){var t;return t=[],l().forEach(function(e){var r,n,a;return a=0,n=0,e.forEach(function(t){return n++,a+=t}),r=a/n,t.push(r.toFixed(1))}),t},s=function(){var t;return t=[],l().forEach(function(e){var r,n,a,o,l,i;for(n=e[0],o=0,a=l=0,i=e.length;i>l;a=++l)r=e[a],r>n&&(n=r,o=a);return t.push([n,o+1879])}),t},u=function(){var t;return t=[],l().forEach(function(e){var r,n,a,o,l,i;for(n=e[0],o=0,a=l=0,i=e.length;i>l;a=++l)r=e[a],n>r&&(n=r,o=a);return t.push([n,o+1879])}),t},c=function(){var e,r,n,a,o,l;for(e=[],o=Object.keys(t[0]),n=+o[0],a=0,l=o.length;l>a;a++)r=o[a],+r>n&&(n=+r);return n},d=function(){var e,r,n,a,o,l;for(e=[],o=Object.keys(t[0]),n=+o[0],a=0,l=o.length;l>a;a++)r=o[a],n>+r&&(n=+r);return n},f=function(){var e,r,n,a,o,l,i,s;for(e=[],l=Object.keys(t[0]),n=+l[0],a=0,i=l.length;i>a;a++)r=l[a],n>+r&&(n=+r);for(e.push(n),o=0,s=l.length;s>o;o++)r=l[o],+r>n&&(n=+r);return e.push(n),e},h=c(),x=d(),e=h-x,m=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],w=12,v=d3.scale.ordinal().domain(y).rangeRoundBands([1.6*w,14.1*w]),b=d3.scale.ordinal().domain([0,1,2,3,4,5,6,7,8,9,10,11]).range(m),g={top:10,right:0,bottom:4,left:40},C=1.2*w*e-g.left-g.right,p=20*w-g.top-g.bottom,Y=d3.select(".heatmap__svg").append("svg").attr("width",C+g.left+g.right).attr("height",p+g.top+g.bottom).append("g").attr("transform","translate("+g.left+","+g.top+")"),Y.append("rect").attr("transform","translate("+-g.left+","+-g.top+")").attr("class","bg").attr("width",C+g.left+g.right).attr("height",p+g.top+g.bottom).attr("fill","#eee"),o=d3.scale.linear().domain([-30,-20,0,1e-4,17,22,27]).range(["#0000FF","#135BA9","#98cced","#eba39f","#e74040","#E50C0C","#bf1919"]),r=h-x+2,A=d3.time.scale().domain([new Date(x,0,1),new Date(h,0,1)]).range([.5*w,w*(e+.5)]),F=Y.append("text").attr("dy",18*w),n=Y.selectAll("g").data(t).enter().append("g").attr("class",function(t,e){return e}).attr("transform",function(t,e){return"translate(0,"+w*(2+e)+")"}),a=n.selectAll("rect").data(function(t){return delete t.month,d3.keys(t).map(function(e){return t[e]})}).enter().append("rect").attr("class","t-rect").attr("width",w).attr("height",w).attr("x",function(t,e){return e*w}).attr("fill",o).attr("opacity",function(t){return null!=t&&""!==t?1:0}).on("mouseover",function(t,e){var r,n,a,o,l;return r=$(this),o=+r.attr("x"),null!=t&&""!==t?(t>0&&null!=t&&(a="+"+t),0>=t&&(a=t),l=e+x,n=b(r.parent().attr("class")),F.text(l+", "+n+": "+a+"°C")):F.text(""),F.attr("dx",o-14)}).on("mouseout",function(){return F.text("")}),Y.append("g").attr("class","axis").attr("transform","translate(-4,"+14*w+")").call(d3.svg.axis().orient("bottom").scale(A).ticks(20)),Y.append("g").call(d3.svg.axis().orient("left").scale(v).ticks(1).tickSize(0).tickFormat(function(t,e){return e%3?null:t})),console.log(0)},$.get("https://raw.githubusercontent.com/neonov/neonov.github.io/master/climate/data/DATA",t)}.call(this),function(){var t,e,r,n,a,o,l,i,s,c,u,d,f,p,g,h,x,m,v,y,b,F,w,Y,C,A,k;f=5,r=10,a=600,d=["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],u={top:10,right:0,bottom:24,left:10},m=400-u.left-u.right,l=300-u.top-u.bottom,h=d3.select(".av-max-min_2__svg").append("svg").attr("width",m+u.left+u.right).attr("height",l+u.top+u.bottom).append("g").attr("transform","translate("+u.left+","+u.top+")"),y=d3.scale.ordinal().domain(d).rangeRoundBands([0,m],.2),F=d3.svg.axis().scale(y).orient("bottom").tickSize(16,0),w=d3.scale.ordinal().domain(d3.range(12)).rangeRoundBands([0,m],.2),k=d3.scale.linear().domain([-25,30]).range([l,0]),A=d3.svg.axis().scale(k).orient("left").ticks(5),e=d3.scale.linear().domain([-45,0,1e-4,45]).range(["#135BA9","#6BB4E3","#F28268","#E50C0C"]),n=function(t){var r,n,a,o,i;return r=t.t,o=t.start,n=t.end,$(".startYear").text(o),$(".endYear").text(n),a=h.append("g").selectAll("rect").data(r).enter().append("rect").attr({"class":"t-rect",x:function(t,e){return w(e)},y:function(t){return k(t)},width:w.rangeBand(),height:function(t){return l-k(t)},fill:e}),i=h.selectAll("text").data(r).enter().append("text").text(function(t){return t}).attr({x:function(t,e){return w(e)+w.rangeBand()/2},y:function(t){return k(t)+16},fill:"#eee","text-anchor":"middle","font-size":"11px"}),h.append("g").attr("class","x2 axis").attr("transform","translate(0,"+l+")").call(F).selectAll(".tick text").style("text-anchor","start").style("font-size","13px").attr("x",-13).attr("y",6),h.append("g").attr("class","y axis").attr("transform","translate(0, 0)")},p=function(t){var r,n,o;return a=600,r=t.t,o=t.start,n=t.end,$(".startYear").text(o),$(".endYear").text(n),e.domain([-30,0,1e-4,35]),h.selectAll(".t-rect").data(r).transition().delay(function(t,e){return 50*e}).attr({y:function(t){return k(t)},width:w.rangeBand(),height:function(t){return l-k(t)},fill:e}),h.selectAll("text").data(r).transition().delay(function(t,e){return 50*e}).text(function(t){return t}).attr({x2:function(t,e){return w(e)+w.rangeBand()/2},y:function(t){return k(t)-13},fill:"#333"})},c={top:20,right:10,bottom:30,left:40},x=670-c.left-c.right,o=300-c.top-c.bottom,v=d3.time.scale().range([0,x]),Y=d3.scale.linear().range([o,0]),b=d3.svg.axis().scale(v).orient("bottom"),C=d3.svg.axis().scale(Y).orient("left").ticks(5),i=d3.svg.line().x(function(t){return v(t.date)}).y(function(t){return Y(t.t)}),g=d3.select(".trend__svg").append("svg").attr("width",x+c.left+c.right).attr("height",o+c.top+c.bottom),t=g.append("g").attr("class","focus").attr("transform","translate("+c.left+","+c.top+")"),s=function(e){var r,a,l,i,s,c,u,d,f,h,x,m,y,F,w,A,k,E,D,B;return A=d3.time.format("%Y").parse,h=function(){var t;return t=[],e.forEach(function(e){var r,n;return r=Object.keys(e),n=r.map(function(t){return{date:A(t),t:e[t]}}),t.push(n)}),t},x=function(t,e){var r;return r=[],h().forEach(function(n){var a,o,l;return l=0,o=0,n.forEach(function(r){var n;return t<=(n=r.date.getFullYear())&&e>=n?(o=e-t+1,l+=r.t):void 0}),a=l/o,r.push(a.toFixed(1))}),r},m=function(t){var e,r,n,a;for(e=new Array(t),r=n=0,a=t;a>=0?a>n:n>a;r=a>=0?++n:--n)e[r]=0;return e},r=function(){var t,e,r,n,a;return e=h(),n=e[0][0].date.getFullYear(),r=e[0].length,a=[],e.forEach(function(t,e){var r,n,o,l,i;for(i=[],r=n=0,o=t.length;o>n;r=++n)l=t[r],i.push(a[r]?a[r]+=l.t:a[r]=l.t);return i}),t=a.map(function(t,e){return{t:t/12,date:A((e+n).toString())}})},F=r(),F.splice(-1,1),d=F,v.domain(d3.extent(d,function(t){return t.date})),D=d3.max(d,function(t){return t.t}),B=d3.min(d,function(t){return t.t}),Y.domain([B,D+1]),g.append("linearGradient").attr("id","temperature-gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",Y(0)).attr("x2",0).attr("y2",Y(8)).selectAll("stop").data([{offset:"0%",color:"#FF69B4"},{offset:"50%",color:"#e74040"},{offset:"100%",color:"#E50C0C"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),c=d3.scale.linear().domain([0,10]).range([2,3]),u=d3.scale.linear().domain([0,4,15]).range(["#eba39f","#e74040","#E50C0C"]),t.selectAll("circle").data(d).enter().append("circle").attr("class","circle").attr("r",function(t){return c(t.t)}).attr("cx",function(t,e){return v(t.date)}).attr("cy",function(t,e){return Y(t.t)}).attr("fill",function(t){return u(t.t)}),t.append("g").attr("class","x axis").attr("transform","translate(0,"+o+")").call(b),t.append("g").attr("class","y axis").call(C).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").attr("font-size","10px").attr("fill","#555").style("text-anchor","end").text("Температура, ºС"),y=g.append("g").attr("class","hover"),y.append("text").attr("x",20).attr("dy",".35em").style("text-anchor","start"),f=function(){var t,e,r,n,a,o,i,s;return a=$(".start"),e=$(".end"),d3.select("g.brush"),o=l.extent()[0].getFullYear(),r=l.extent()[1].getFullYear(),i=$(".sign-start"),n=$(".sign-period"),t=$(".dash"),s=$(".year"),1981!==o||2010!==r?(i.addClass("hide"),n.removeClass("hide"),o===r?(a.text(o),e.addClass("hide"),t.addClass("hide"),s.text(" г.")):(t.removeClass("hide"),e.removeClass("hide"),a.text(o),e.text(r),s.text(" гг."))):(n.addClass("hide"),i.removeClass("hide"))},a=d3.bisector(function(t){return t.date}).left,k=t.append("g").attr("class","popup").style("display","none"),k.append("circle").attr("class","popup__circle").attr("r",4.5),E=k.append("text").attr("class","popup__text").attr("font-weight","bold").attr("font-size","10px").data(d).attr("dy",-10).attr("x",0),w=function(){var t,e,r,n,o;return o=v.invert(d3.mouse(this)[0]),n=a(d,o),e=d[n-1],r=d[n],e&&r?(t=o-e.date>r.date-o?r:e,k.attr("transform","translate("+v(t.date)+","+Y(t.t)+")"),k.select("text").text(t.date.getFullYear()+", "+t.t.toFixed(1)+" °C"),E.attr("text-anchor",function(){return o.getFullYear()>2e3?"end":"start"})):void 0},s=function(){var t,e,r,n;return n=l.extent()[0].getFullYear(),e=l.extent()[1].getFullYear(),p({t:x(n,e)}),r=$(".start"),t=$(".end"),f()},l=d3.svg.brush().x(v).extent([new Date(1981,0,1),new Date(2010,0,1)]).on("brush",s),i=t.append("g").attr("class","brush").call(l).on("mouseover",function(){return k.style("display",null)}).on("mouseout",function(){return k.style("display","none")}).on("mousemove",w),i.selectAll("rect").attr("height",o),function(){var t,e;return d3.select("g.brush").call(l.extent([new Date(1981,0,1),new Date(2010,0,1)])),t=l.extent()[1].getFullYear(),e=l.extent()[0].getFullYear(),n({t:x(e,t)}),p({t:x(e,t)})}(),$(".climat1").on("click",function(t){var e,r;return t.preventDefault(),d3.select("g.brush").call(l.extent([new Date(1879,0,1),new Date(1899,0,1)])),e=l.extent()[1].getFullYear(),r=l.extent()[0].getFullYear(),p({t:x(r,e)}),f()}),$(".climat2").on("click",function(t){var e,r;return t.preventDefault(),d3.select("g.brush").call(l.extent([new Date(2e3,0,1),new Date(2014,0,1)])),e=l.extent()[1].getFullYear(),r=l.extent()[0].getFullYear(),p({t:x(r,e)}),f()})},$.get("https://raw.githubusercontent.com/neonov/neonov.github.io/master/climate/data/DATA",s)}.call(this);
//# sourceMappingURL=all.min.js.map